!function(a){"use strict";a.widget("custom.slotMachine",{options:{numSlotsToShow:3,easeOutSpeed:1e3,minRounds:7,slotDifferenceFactor:5,spinSpeed:200,hasShaders:!0,leverThreshold:.7},_create:function(){if(this.options.numSlotsToShow%2===0)throw"slotMachine: numSlotsToShow must be an odd number";this.$slotReels=this.element.find(".slot-reels"),this.$slotReel=this.$slotReels.children(),this.numRows=this.$slotReel.length,this.numReels=this.$slotReel.eq(0).children().length,this.options.hasShaders&&this._appendShaders(),this._createLever(),this._appendExtraSlots(),this._makeResponsive()},_appendShaders:function(){var b=Math.floor(this.options.numSlotsToShow/2),c=100/this.options.numSlotsToShow*b;this.$topShader=a('<div class="slot-top-shader"></div>'),this.$bottomShader=a('<div class="slot-bottom-shader"></div>'),this.$topShader.css("height",c+"%"),this.$bottomShader.css("height",c+"%"),this.$slotReels.prepend(this.$topShader).append(this.$bottomShader)},_createLever:function(){var b=this,c=this.element.find(".slot-main");this.$lever=a('<div class="slot-lever"></div>'),this.$leverTrack=a('<div class="slot-lever-track"></div>'),c.prepend(this.$lever).prepend(this.$leverTrack);var d=this.$lever.height();this.$lever.draggable({axis:"y",containment:c,revert:!0,stop:function(a,e){b.$lever.css({left:"",top:""});var f=e.position.top/(c.height()-d);f>=b.options.leverThreshold&&b.spin()}})},_appendExtraSlots:function(){var b=this;this.extraSlots=[],this.$slotReel.each(function(){for(var c,d=a(this),e=1;e<=b.options.numSlotsToShow;e=2*e)c=d.children().clone(),b.extraSlots.push.apply(b.extraSlots,c),d.append(c);d.css("bottom",0)})},_makeResponsive:function(){this.$slotReel.css("width",100/this.numReels+"%");var a=100/this.options.numSlotsToShow+"%";this.element.find(".slot-box").css("height",a)},_getRandomSlot:function(a,b){var c=Math.floor(Math.random()*a),d=Math.floor(c*b);return d},_spinAnimation:function(b,c,d,e,f,g){var h=f>=g;c.animate({bottom:h?b._getRandomSlot(b.numRows,d):e},{easing:h?"easeOutBounce":"linear",duration:h?b.options.easeOutSpeed:b.options.spinSpeed,complete:function(){h||(a(this).css("bottom",0),b._spinAnimation(b,c,d,e,f+1,g))}})},spin:function(){var b=this,c=this.$slotReel.eq(0).height()/b.options.numSlotsToShow,d=Math.floor(c*b.numRows);this.$slotReel.each(function(e){var f=e*b.options.slotDifferenceFactor+b.options.minRounds;b._spinAnimation(b,a(this),c,d,0,f)})},destroy:function(){this.options.hasShaders&&(this.$topShader.remove(),this.$bottomShader.remove()),this.$lever.remove(),this.$leverTrack.remove(),a.each(this.extraSlots,function(a,b){b.remove()})}})}(jQuery);